# Milvus installation


## Prepare Kubernetes

<!--

- Set the config file to the correct path:

```bash
export KUBECONFIG=/root/.kube/config
```
-->

- Ensure that the correct context is being used by running:

```bash
sudo kubectl config use-context kind-kind
```


<!--

- Start a K8s cluster using kind

```bash
sudo kind create cluster
```
-->


## Install Helm Chart for Milvus


- Add the Milvus chart repository to Helm:

```bash
sudo helm repo add milvus https://milvus-io.github.io/milvus-helm/
```

- Update your local chart repository.

```bash
sudo helm repo update
```

## Start Milvus

Start Milvus with Helm by specifying the release name, the chart, and parameters you expect to change. This topic uses `my-release` as the release name. To use a different release name, replace `my-release` in the command.


```
sudo helm install my-release milvus/milvus \
  --set cluster.enabled=false \
  --set etcd.replicaCount=1 \
  --set minio.mode=standalone \
  --set pulsar.enabled=false
```

This should output something like:

```bash
NAME: my-release
LAST DEPLOYED: Tue May 16 18:38:40 2023
NAMESPACE: default
STATUS: deployed
REVISION: 1
TEST SUITE: None
```

Check the status of the running pods.

```bash
sudo kubectl get pods
```

This outputs:

```bash
my-release-etcd-0                               1/1     Running            0          3m15s
my-release-milvus-standalone-66cdddd564-vbrgr   0/1     ImagePullBackOff   0          3m15s
my-release-minio-55cf49d57d-bmx5m               1/1     Running            0          3m15s
```

## Connect to Milvus

Verify which local port the Milvus server is listening on. Replace the pod name with your own.

```bash
sudo kubectl get pod my-release-milvus-standalone-66cdddd564-vbrgr --template='{{(index (index .spec.containers 0).ports 0).containerPort}}{{"\n"}}'
```

<!--
sudo kubectl get pod my-release-milvus-standalone-66cdddd564-8vg7l --template='{{(index (index .spec.containers 0).ports 0).containerPort}}{{"\n"}}'

-->

Output:

```bash
19530
```


NOT WORKiNG

Open a new terminal and run the following command to forward a local port to the port that Milvus uses. Optionally, omit the designated port and use :19530 to let kubectl allocate a local port for you so that you don't have to manage port conflicts.

```bash
sudo kubectl port-forward my-release-milvus-standalone-66cdddd564-vbrgr 27017:19530
```

PROBLEM
error: unable to forward port because pod is not running. Current status=Pending


## Python example project

 - Change directory

```bash
cd /mnt/vdb/github
```


- Create a new directory

```bash
mkdir milvus
```

- Change directory

```bash
cd milvus
```

- Get the Milvus Python starter code

```bash
curl -L -O https://raw.githubusercontent.com/milvus-io/pymilvus/master/examples/hello_milvus.py
```

- Open the file in VS Code: `/mnt/vdb/github/milvus/hello_milvus.py`
